{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"C:/Users/MOHAM/Desktop/Team-Finder-Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"C:/Users/MOHAM/Desktop/Team-Finder-Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar DOMException = require(\"domexception/webidl2js-wrapper\");\n\nvar NODE_TYPE = require(\"../node-type\");\n\nvar _require = require(\"../helpers/node\"),\n    nodeLength = _require.nodeLength,\n    nodeRoot = _require.nodeRoot;\n\nvar _require2 = require(\"../helpers/internal-constants\"),\n    domSymbolTree = _require2.domSymbolTree;\n\nvar _require3 = require(\"../range/boundary-point\"),\n    compareBoundaryPointsPosition = _require3.compareBoundaryPointsPosition;\n\nvar _require4 = require(\"../range/Range-impl\"),\n    setBoundaryPointStart = _require4.setBoundaryPointStart,\n    setBoundaryPointEnd = _require4.setBoundaryPointEnd;\n\nvar Range = require(\"../generated/Range\");\n\nvar _require5 = require(\"../generated/utils\"),\n    implForWrapper = _require5.implForWrapper; // https://w3c.github.io/selection-api/#dfn-direction\n\n\nvar SELECTION_DIRECTION = {\n  FORWARDS: 1,\n  BACKWARDS: -1,\n  DIRECTIONLESS: 0\n}; // https://w3c.github.io/selection-api/#dom-selection\n\nvar SelectionImpl = /*#__PURE__*/function () {\n  function SelectionImpl(globalObject) {\n    _classCallCheck(this, SelectionImpl);\n\n    this._range = null;\n    this._direction = SELECTION_DIRECTION.DIRECTIONLESS;\n    this._globalObject = globalObject;\n  } // https://w3c.github.io/selection-api/#dom-selection-anchornode\n\n\n  _createClass(SelectionImpl, [{\n    key: \"getRangeAt\",\n    // https://w3c.github.io/selection-api/#dom-selection-getrangeat\n    value: function getRangeAt(index) {\n      if (index !== 0 || this._isEmpty()) {\n        throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n      }\n\n      return this._range;\n    } // https://w3c.github.io/selection-api/#dom-selection-addrange\n\n  }, {\n    key: \"addRange\",\n    value: function addRange(range) {\n      if (range._root === implForWrapper(this._globalObject._document) && this.rangeCount === 0) {\n        this._associateRange(range);\n      }\n    } // https://w3c.github.io/selection-api/#dom-selection-removerange\n\n  }, {\n    key: \"removeRange\",\n    value: function removeRange(range) {\n      if (range !== this._range) {\n        throw DOMException.create(this._globalObject, [\"Invalid range.\", \"NotFoundError\"]);\n      }\n\n      this._associateRange(null);\n    } // https://w3c.github.io/selection-api/#dom-selection-removeallranges\n\n  }, {\n    key: \"removeAllRanges\",\n    value: function removeAllRanges() {\n      this._associateRange(null);\n    } // https://w3c.github.io/selection-api/#dom-selection-empty\n\n  }, {\n    key: \"empty\",\n    value: function empty() {\n      this.removeAllRanges();\n    } // https://w3c.github.io/selection-api/#dom-selection-collapse\n\n  }, {\n    key: \"collapse\",\n    value: function collapse(node, offset) {\n      if (node === null) {\n        this.removeAllRanges();\n        return;\n      }\n\n      if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n        throw DOMException.create(this._globalObject, [\"DocumentType Node can't be used as boundary point.\", \"InvalidNodeTypeError\"]);\n      }\n\n      if (offset > nodeLength(node)) {\n        throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n      }\n\n      if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n        return;\n      }\n\n      var newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: node,\n          offset: 0\n        },\n        end: {\n          node: node,\n          offset: 0\n        }\n      });\n      setBoundaryPointStart(newRange, node, offset);\n      setBoundaryPointEnd(newRange, node, offset);\n\n      this._associateRange(newRange);\n    } // https://w3c.github.io/selection-api/#dom-selection-setposition\n\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(node, offset) {\n      this.collapse(node, offset);\n    } // https://w3c.github.io/selection-api/#dom-selection-collapsetostart\n\n  }, {\n    key: \"collapseToStart\",\n    value: function collapseToStart() {\n      if (this._isEmpty()) {\n        throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n      }\n\n      var _this$_range$_start = this._range._start,\n          node = _this$_range$_start.node,\n          offset = _this$_range$_start.offset;\n      var newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: node,\n          offset: offset\n        },\n        end: {\n          node: node,\n          offset: offset\n        }\n      });\n\n      this._associateRange(newRange);\n    } // https://w3c.github.io/selection-api/#dom-selection-collapsetoend\n\n  }, {\n    key: \"collapseToEnd\",\n    value: function collapseToEnd() {\n      if (this._isEmpty()) {\n        throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n      }\n\n      var _this$_range$_end = this._range._end,\n          node = _this$_range$_end.node,\n          offset = _this$_range$_end.offset;\n      var newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: node,\n          offset: offset\n        },\n        end: {\n          node: node,\n          offset: offset\n        }\n      });\n\n      this._associateRange(newRange);\n    } // https://w3c.github.io/selection-api/#dom-selection-extend\n\n  }, {\n    key: \"extend\",\n    value: function extend(node, offset) {\n      if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n        return;\n      }\n\n      if (this._isEmpty()) {\n        throw DOMException.create(this._globalObject, [\"There is no selection to extend.\", \"InvalidStateError\"]);\n      }\n\n      var oldAnchor = this._anchor;\n      var newFocus = {\n        node: node,\n        offset: offset\n      };\n      var newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: node,\n          offset: 0\n        },\n        end: {\n          node: node,\n          offset: 0\n        }\n      });\n\n      if (nodeRoot(node) !== this._range._root) {\n        setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n        setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n      } else if (compareBoundaryPointsPosition(oldAnchor, newFocus) <= 0) {\n        setBoundaryPointStart(newRange, oldAnchor.node, oldAnchor.offset);\n        setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n      } else {\n        setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n        setBoundaryPointEnd(newRange, oldAnchor.node, oldAnchor.offset);\n      }\n\n      this._associateRange(newRange);\n\n      this._direction = compareBoundaryPointsPosition(newFocus, oldAnchor) === -1 ? SELECTION_DIRECTION.BACKWARDS : SELECTION_DIRECTION.FORWARDS;\n    } // https://w3c.github.io/selection-api/#dom-selection-setbaseandextent\n\n  }, {\n    key: \"setBaseAndExtent\",\n    value: function setBaseAndExtent(anchorNode, anchorOffset, focusNode, focusOffset) {\n      if (anchorOffset > nodeLength(anchorNode) || focusOffset > nodeLength(focusNode)) {\n        throw DOMException.create(this._globalObject, [\"Invalid anchor or focus offset.\", \"IndexSizeError\"]);\n      }\n\n      var document = implForWrapper(this._globalObject._document);\n\n      if (document !== nodeRoot(anchorNode) || document !== nodeRoot(focusNode)) {\n        return;\n      }\n\n      var anchor = {\n        node: anchorNode,\n        offset: anchorOffset\n      };\n      var focus = {\n        node: focusNode,\n        offset: focusOffset\n      };\n      var newRange;\n\n      if (compareBoundaryPointsPosition(anchor, focus) === -1) {\n        newRange = Range.createImpl(this._globalObject, [], {\n          start: {\n            node: anchor.node,\n            offset: anchor.offset\n          },\n          end: {\n            node: focus.node,\n            offset: focus.offset\n          }\n        });\n      } else {\n        newRange = Range.createImpl(this._globalObject, [], {\n          start: {\n            node: focus.node,\n            offset: focus.offset\n          },\n          end: {\n            node: anchor.node,\n            offset: anchor.offset\n          }\n        });\n      }\n\n      this._associateRange(newRange);\n\n      this._direction = compareBoundaryPointsPosition(focus, anchor) === -1 ? SELECTION_DIRECTION.BACKWARDS : SELECTION_DIRECTION.FORWARDS;\n    } // https://w3c.github.io/selection-api/#dom-selection-selectallchildren\n\n  }, {\n    key: \"selectAllChildren\",\n    value: function selectAllChildren(node) {\n      if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n        throw DOMException.create(this._globalObject, [\"DocumentType Node can't be used as boundary point.\", \"InvalidNodeTypeError\"]);\n      }\n\n      var document = implForWrapper(this._globalObject._document);\n\n      if (document !== nodeRoot(node)) {\n        return;\n      }\n\n      var length = domSymbolTree.childrenCount(node);\n      var newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: node,\n          offset: 0\n        },\n        end: {\n          node: node,\n          offset: 0\n        }\n      });\n      setBoundaryPointStart(newRange, node, 0);\n      setBoundaryPointEnd(newRange, node, length);\n\n      this._associateRange(newRange);\n    } // https://w3c.github.io/selection-api/#dom-selection-deletefromdocument\n\n  }, {\n    key: \"deleteFromDocument\",\n    value: function deleteFromDocument() {\n      if (!this._isEmpty()) {\n        this._range.deleteContents();\n      }\n    } // https://w3c.github.io/selection-api/#dom-selection-containsnode\n\n  }, {\n    key: \"containsNode\",\n    value: function containsNode(node, allowPartialContainment) {\n      if (this._isEmpty() || nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n        return false;\n      }\n\n      var _this$_range = this._range,\n          _start = _this$_range._start,\n          _end = _this$_range._end;\n      var startIsBeforeNode = compareBoundaryPointsPosition(_start, {\n        node: node,\n        offset: 0\n      }) === -1;\n      var endIsAfterNode = compareBoundaryPointsPosition(_end, {\n        node: node,\n        offset: nodeLength(node)\n      }) === 1;\n      return allowPartialContainment ? startIsBeforeNode || endIsAfterNode : startIsBeforeNode && endIsAfterNode;\n    } // https://w3c.github.io/selection-api/#dom-selection-stringifier\n\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this._range ? this._range.toString() : \"\";\n    } // https://w3c.github.io/selection-api/#dfn-empty\n\n  }, {\n    key: \"_isEmpty\",\n    value: function _isEmpty() {\n      return this._range === null;\n    } // https://w3c.github.io/selection-api/#dfn-anchor\n\n  }, {\n    key: \"_associateRange\",\n    value: function _associateRange(newRange) {\n      this._range = newRange;\n      this._direction = newRange === null ? SELECTION_DIRECTION.DIRECTIONLESS : SELECTION_DIRECTION.FORWARDS; // TODO: Emit \"selectionchange\" event. At this time, there is currently no test in WPT covering this.\n      // https://w3c.github.io/selection-api/#selectionchange-event\n    }\n  }, {\n    key: \"anchorNode\",\n    get: function get() {\n      var anchor = this._anchor;\n      return anchor ? anchor.node : null;\n    } // https://w3c.github.io/selection-api/#dom-selection-anchoroffset\n\n  }, {\n    key: \"anchorOffset\",\n    get: function get() {\n      var anchor = this._anchor;\n      return anchor ? anchor.offset : 0;\n    } // https://w3c.github.io/selection-api/#dom-selection-focusnode\n\n  }, {\n    key: \"focusNode\",\n    get: function get() {\n      var focus = this._focus;\n      return focus ? focus.node : null;\n    } // https://w3c.github.io/selection-api/#dom-selection-focusoffset\n\n  }, {\n    key: \"focusOffset\",\n    get: function get() {\n      var focus = this._focus;\n      return focus ? focus.offset : 0;\n    } // https://w3c.github.io/selection-api/#dom-selection-iscollapsed\n\n  }, {\n    key: \"isCollapsed\",\n    get: function get() {\n      return this._range === null || this._range.collapsed;\n    } // https://w3c.github.io/selection-api/#dom-selection-rangecount\n\n  }, {\n    key: \"rangeCount\",\n    get: function get() {\n      return this._isEmpty() ? 0 : 1;\n    } // https://w3c.github.io/selection-api/#dom-selection-type\n\n  }, {\n    key: \"type\",\n    get: function get() {\n      if (this._isEmpty()) {\n        return \"None\";\n      } else if (this._range.collapsed) {\n        return \"Caret\";\n      }\n\n      return \"Range\";\n    }\n  }, {\n    key: \"_anchor\",\n    get: function get() {\n      if (!this._range) {\n        return null;\n      }\n\n      return this._direction === SELECTION_DIRECTION.FORWARDS ? this._range._start : this._range._end;\n    } // https://w3c.github.io/selection-api/#dfn-focus\n\n  }, {\n    key: \"_focus\",\n    get: function get() {\n      if (!this._range) {\n        return null;\n      }\n\n      return this._direction === SELECTION_DIRECTION.FORWARDS ? this._range._end : this._range._start;\n    }\n  }]);\n\n  return SelectionImpl;\n}();\n\nmodule.exports = {\n  implementation: SelectionImpl\n};","map":{"version":3,"sources":["C:/Users/MOHAM/Desktop/Team-Finder-Client/node_modules/jsdom/lib/jsdom/living/selection/Selection-impl.js"],"names":["DOMException","require","NODE_TYPE","nodeLength","nodeRoot","domSymbolTree","compareBoundaryPointsPosition","setBoundaryPointStart","setBoundaryPointEnd","Range","implForWrapper","SELECTION_DIRECTION","FORWARDS","BACKWARDS","DIRECTIONLESS","SelectionImpl","globalObject","_range","_direction","_globalObject","index","_isEmpty","create","range","_root","_document","rangeCount","_associateRange","removeAllRanges","node","offset","nodeType","DOCUMENT_TYPE_NODE","newRange","createImpl","start","end","collapse","_start","_end","oldAnchor","_anchor","newFocus","anchorNode","anchorOffset","focusNode","focusOffset","document","anchor","focus","length","childrenCount","deleteContents","allowPartialContainment","startIsBeforeNode","endIsAfterNode","toString","_focus","collapsed","module","exports","implementation"],"mappings":"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","sourcesContent":["\"use strict\";\n\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nconst NODE_TYPE = require(\"../node-type\");\nconst { nodeLength, nodeRoot } = require(\"../helpers/node\");\nconst { domSymbolTree } = require(\"../helpers/internal-constants\");\nconst { compareBoundaryPointsPosition } = require(\"../range/boundary-point\");\n\nconst { setBoundaryPointStart, setBoundaryPointEnd } = require(\"../range/Range-impl\");\n\nconst Range = require(\"../generated/Range\");\nconst { implForWrapper } = require(\"../generated/utils\");\n\n// https://w3c.github.io/selection-api/#dfn-direction\nconst SELECTION_DIRECTION = {\n  FORWARDS: 1,\n  BACKWARDS: -1,\n  DIRECTIONLESS: 0\n};\n\n// https://w3c.github.io/selection-api/#dom-selection\nclass SelectionImpl {\n  constructor(globalObject) {\n    this._range = null;\n    this._direction = SELECTION_DIRECTION.DIRECTIONLESS;\n\n    this._globalObject = globalObject;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-anchornode\n  get anchorNode() {\n    const anchor = this._anchor;\n    return anchor ? anchor.node : null;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-anchoroffset\n  get anchorOffset() {\n    const anchor = this._anchor;\n    return anchor ? anchor.offset : 0;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-focusnode\n  get focusNode() {\n    const focus = this._focus;\n    return focus ? focus.node : null;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-focusoffset\n  get focusOffset() {\n    const focus = this._focus;\n    return focus ? focus.offset : 0;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-iscollapsed\n  get isCollapsed() {\n    return this._range === null || this._range.collapsed;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-rangecount\n  get rangeCount() {\n    return this._isEmpty() ? 0 : 1;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-type\n  get type() {\n    if (this._isEmpty()) {\n      return \"None\";\n    } else if (this._range.collapsed) {\n      return \"Caret\";\n    }\n\n    return \"Range\";\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-getrangeat\n  getRangeAt(index) {\n    if (index !== 0 || this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n    }\n\n    return this._range;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-addrange\n  addRange(range) {\n    if (range._root === implForWrapper(this._globalObject._document) && this.rangeCount === 0) {\n      this._associateRange(range);\n    }\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-removerange\n  removeRange(range) {\n    if (range !== this._range) {\n      throw DOMException.create(this._globalObject, [\"Invalid range.\", \"NotFoundError\"]);\n    }\n\n    this._associateRange(null);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-removeallranges\n  removeAllRanges() {\n    this._associateRange(null);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-empty\n  empty() {\n    this.removeAllRanges();\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-collapse\n  collapse(node, offset) {\n    if (node === null) {\n      this.removeAllRanges();\n      return;\n    }\n\n    if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n      throw DOMException.create(this._globalObject, [\n        \"DocumentType Node can't be used as boundary point.\",\n        \"InvalidNodeTypeError\"\n      ]);\n    }\n\n    if (offset > nodeLength(node)) {\n      throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n    }\n\n    if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return;\n    }\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset: 0 },\n      end: { node, offset: 0 }\n    });\n\n    setBoundaryPointStart(newRange, node, offset);\n    setBoundaryPointEnd(newRange, node, offset);\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-setposition\n  setPosition(node, offset) {\n    this.collapse(node, offset);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-collapsetostart\n  collapseToStart() {\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n    }\n\n    const { node, offset } = this._range._start;\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset },\n      end: { node, offset }\n    });\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-collapsetoend\n  collapseToEnd() {\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n    }\n\n    const { node, offset } = this._range._end;\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset },\n      end: { node, offset }\n    });\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-extend\n  extend(node, offset) {\n    if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return;\n    }\n\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to extend.\", \"InvalidStateError\"]);\n    }\n\n    const { _anchor: oldAnchor } = this;\n    const newFocus = { node, offset };\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset: 0 },\n      end: { node, offset: 0 }\n    });\n\n    if (nodeRoot(node) !== this._range._root) {\n      setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n      setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n    } else if (compareBoundaryPointsPosition(oldAnchor, newFocus) <= 0) {\n      setBoundaryPointStart(newRange, oldAnchor.node, oldAnchor.offset);\n      setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n    } else {\n      setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n      setBoundaryPointEnd(newRange, oldAnchor.node, oldAnchor.offset);\n    }\n\n    this._associateRange(newRange);\n\n    this._direction = compareBoundaryPointsPosition(newFocus, oldAnchor) === -1 ?\n      SELECTION_DIRECTION.BACKWARDS :\n      SELECTION_DIRECTION.FORWARDS;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-setbaseandextent\n  setBaseAndExtent(anchorNode, anchorOffset, focusNode, focusOffset) {\n    if (anchorOffset > nodeLength(anchorNode) || focusOffset > nodeLength(focusNode)) {\n      throw DOMException.create(this._globalObject, [\"Invalid anchor or focus offset.\", \"IndexSizeError\"]);\n    }\n\n    const document = implForWrapper(this._globalObject._document);\n    if (document !== nodeRoot(anchorNode) || document !== nodeRoot(focusNode)) {\n      return;\n    }\n\n    const anchor = { node: anchorNode, offset: anchorOffset };\n    const focus = { node: focusNode, offset: focusOffset };\n\n    let newRange;\n    if (compareBoundaryPointsPosition(anchor, focus) === -1) {\n      newRange = Range.createImpl(this._globalObject, [], {\n        start: { node: anchor.node, offset: anchor.offset },\n        end: { node: focus.node, offset: focus.offset }\n      });\n    } else {\n      newRange = Range.createImpl(this._globalObject, [], {\n        start: { node: focus.node, offset: focus.offset },\n        end: { node: anchor.node, offset: anchor.offset }\n      });\n    }\n\n    this._associateRange(newRange);\n\n    this._direction = compareBoundaryPointsPosition(focus, anchor) === -1 ?\n      SELECTION_DIRECTION.BACKWARDS :\n      SELECTION_DIRECTION.FORWARDS;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-selectallchildren\n  selectAllChildren(node) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n      throw DOMException.create(this._globalObject, [\n        \"DocumentType Node can't be used as boundary point.\",\n        \"InvalidNodeTypeError\"\n      ]);\n    }\n\n    const document = implForWrapper(this._globalObject._document);\n    if (document !== nodeRoot(node)) {\n      return;\n    }\n\n    const length = domSymbolTree.childrenCount(node);\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset: 0 },\n      end: { node, offset: 0 }\n    });\n\n    setBoundaryPointStart(newRange, node, 0);\n    setBoundaryPointEnd(newRange, node, length);\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-deletefromdocument\n  deleteFromDocument() {\n    if (!this._isEmpty()) {\n      this._range.deleteContents();\n    }\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-containsnode\n  containsNode(node, allowPartialContainment) {\n    if (this._isEmpty() || nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return false;\n    }\n\n    const { _start, _end } = this._range;\n\n    const startIsBeforeNode = compareBoundaryPointsPosition(_start, { node, offset: 0 }) === -1;\n    const endIsAfterNode = compareBoundaryPointsPosition(_end, { node, offset: nodeLength(node) }) === 1;\n\n    return allowPartialContainment ?\n      startIsBeforeNode || endIsAfterNode :\n      startIsBeforeNode && endIsAfterNode;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-stringifier\n  toString() {\n    return this._range ? this._range.toString() : \"\";\n  }\n\n  // https://w3c.github.io/selection-api/#dfn-empty\n  _isEmpty() {\n    return this._range === null;\n  }\n\n  // https://w3c.github.io/selection-api/#dfn-anchor\n  get _anchor() {\n    if (!this._range) {\n      return null;\n    }\n\n    return this._direction === SELECTION_DIRECTION.FORWARDS ?\n      this._range._start :\n      this._range._end;\n  }\n\n  // https://w3c.github.io/selection-api/#dfn-focus\n  get _focus() {\n    if (!this._range) {\n      return null;\n    }\n\n    return this._direction === SELECTION_DIRECTION.FORWARDS ?\n      this._range._end :\n      this._range._start;\n  }\n\n  _associateRange(newRange) {\n    this._range = newRange;\n    this._direction = newRange === null ? SELECTION_DIRECTION.DIRECTIONLESS : SELECTION_DIRECTION.FORWARDS;\n\n    // TODO: Emit \"selectionchange\" event. At this time, there is currently no test in WPT covering this.\n    // https://w3c.github.io/selection-api/#selectionchange-event\n  }\n}\n\nmodule.exports = {\n  implementation: SelectionImpl\n};\n"]},"metadata":{},"sourceType":"script"}